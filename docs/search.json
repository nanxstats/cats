[{"path":"https://nanx.me/cats/articles/cats.html","id":"a-simple-run","dir":"Articles","previous_headings":"","what":"A simple run","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs","text":"","code":"library(\"cats\")  cats(   freq = 0.2,   ncases = 500, ncases2 = 500,   ncontrols = 1000, ncontrols2 = 1000,   risk = 1.5, multiplicative = 1 ) #> Expected Power is; #>  #>       #>  #>                    For a one-stage study = 0.94 #>       For first stage in two-stage study = 0.972 #> For second stage in replication analysis = 0.784 #>     For second stage in a joint analysis = 0.929 #>                                       pi = 0.5"},{"path":[]},{"path":"https://nanx.me/cats/articles/cats.html","id":"which-design-is-better","dir":"Articles","previous_headings":"Plot examples","what":"Which design is better","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs","text":"","code":"rr <- seq(1, 2, by = 0.05) maf <- c(0.05, 0.1, 0.2, 0.5) c2 <- curve.cats(rr, maf,   ncases = 600, ncontrols = 600, ncases2 = 600,   ncontrols2 = 600, alpha = 0.000001, prevalence = 0.01 ) #> 1  2  3  4 plot(c2, type = \"One\", main = \"power2\", ylab = \"Power\", xlab = \"RR\", file = NULL, col = 1:4) lines.cats(c2, type = \"Replication\", lty = 3) lines.cats(c2, type = \"Joint\", lty = 2) lines.cats(c2, type = \"First\", lty = 4) legend(\"left\", c(\"One stage\", \"Joint\", \"Relication\", \"First Stage\"), lty = 1:4, bty = \"n\")"},{"path":"https://nanx.me/cats/articles/cats.html","id":"number-of-snps-for-replication","dir":"Articles","previous_headings":"Plot examples","what":"Number of SNPs for replication","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs","text":"","code":"power.J96 <- c() power.J1536 <- c() RR <- seq(1.1, 1.5, by = 0.025) maf <- c(5, 10, 20, 50) / 100  for (tal2 in 1:length(maf)) {   J1 <- c()   J2 <- c()   for (tal in 1:length(RR)) {     temp <- cats(       freq = maf[tal2], ncases = 1500, ncontrols = 1500, ncases2 = 2000,       ncontrols2 = 2000, risk = RR[tal], pimarkers = 96 / 300000, alpha = 0.05 / 300000     )     J1[tal] <- temp$P.joint     temp <- cats(       freq = maf[tal2], ncases = 1500, ncontrols = 1500, ncases2 = 2000,       ncontrols2 = 2000, risk = RR[tal], pimarkers = 1536 / 300000, alpha = 0.05 / 300000     )     J2[tal] <- temp$P.joint   }   power.J96 <- cbind(power.J96, J1)   power.J1536 <- cbind(power.J1536, J2) } col <- 1:length(maf)  plot(RR, power.J1536[, 1], type = \"l\", lwd = 2, ylab = \"Power\", main = \"Multiplicative model,  1500:1500, 2000:2000\", col = col[1], ylim = 0:1) for (tal2 in 2:length(maf)) lines(RR, power.J1536[, tal2], lwd = 2, col = col[tal2], type = \"l\") for (tal2 in 1:length(maf)) lines(RR, power.J96[, tal2], lwd = 2, col = col[tal2], type = \"l\", lty = 2) legend(\"bottomright\", c(paste(\"MAF=\", c(maf), \", rep=1536\"), paste(\"MAF=\", c(maf), \", rep=96\")), col = col, lwd = 2, bty = \"n\", lty = c(rep(1, length(maf)), rep(2, length(maf))))"},{"path":"https://nanx.me/cats/articles/cats.html","id":"heatmap-of-power","dir":"Articles","previous_headings":"Plot examples","what":"Heatmap of power","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs","text":"","code":"rr <- seq(1, 2, by = 0.025) c <- super.cats(rr,   by = length(rr), ncases = 765, ncontrols = 1274, ncases2 = 100, ncontrols2 = 100,   alpha = 0.001, prevalence = 0.01 ) #> 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42 plot(c, main = \"power\", file = NULL)"},{"path":"https://nanx.me/cats/articles/cats.html","id":"design-and-maf","dir":"Articles","previous_headings":"Plot examples","what":"Design and MAF","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs","text":"","code":"rr <- seq(1, 2, by = 0.05) maf <- c(0.05, 0.1, 0.2, 0.5) c2 <- curve.cats(rr, maf,   ncases = 600, ncontrols = 600, ncases2 = 600, ncontrols2 = 600,   alpha = 0.000001, prevalence = 0.01 ) #> 1  2  3  4  plot(c2, type = \"One\", main = \"power2\", ylab = \"Power\", xlab = \"RR\", file = NULL, col = 1:4) lines.cats(c2, type = \"Replication\", lty = 3) lines.cats(c2, type = \"Joint\", lty = 2) lines.cats(c2, type = \"First\", lty = 4) legend(\"left\", c(\"One stage\", \"Joint\", \"Relication\", \"First Stage\"), lty = 1:4, bty = \"n\")"},{"path":"https://nanx.me/cats/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Anders Albrechtsen. Author. Nan Xiao. Maintainer, contributor.","code":""},{"path":"https://nanx.me/cats/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Albrechtsen (2021). cats: Joint Power Analysis Non-Symmetric Two-Stage Case-Control Designs SNP Data. https://nanx./cats/, https://github.com/nanxstats/cats.","code":"@Manual{,   title = {cats: Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs for SNP Data},   author = {Anders Albrechtsen},   year = {2021},   note = {https://nanx.me/cats/, https://github.com/nanxstats/cats}, }"},{"path":"https://nanx.me/cats/index.html","id":"cats","dir":"","previous_headings":"","what":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"cats fork R package CATS developed Anders Albrechtsen <aalbrechtsen@bio.ku.dk> power estimation two-stage genome-wide association designs. See vignette code examples.","code":""},{"path":"https://nanx.me/cats/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"","code":"# install.packages(\"devtools\") devtools::install_github(\"nanxstats/cats\")"},{"path":"https://nanx.me/cats/index.html","id":"method","dir":"","previous_headings":"","what":"Method","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"method power analysis implemented CATS based Skol et al. 2006, generalized ratio cases controls may vary stages. allele frequencies, disease prevalence, relative risk can also vary.","code":""},{"path":"https://nanx.me/cats/index.html","id":"changes","dir":"","previous_headings":"","what":"Changes","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"changes made original R package CATS fixing package build check issues (R 3.6.0 May 2019), example: Used unified lowercase names package functions Fixed C code build errors warnings (now passes clang) Fixed package formatting issues blocks building checking Used roxygen2 automate namespace documentation generation Organized existing code examples vignette","code":""},{"path":"https://nanx.me/cats/index.html","id":"source","dir":"","previous_headings":"","what":"Source","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"package forked modified resources. also available archives bin/: Code examples Source tarball PDF manual","code":""},{"path":"https://nanx.me/cats/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Joint Power Analysis for Non-Symmetric Two-Stage Case-Control Designs\n    for SNP Data","text":"Skol AD, Scott LJ, Abecasis GR, Boehnke M: Joint analysis efficient replication-based analysis two-stage genome-wide association studies. Nat Genet 38: 209-213, 2006.","code":""},{"path":"https://nanx.me/cats/reference/cats-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats-package","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats-package","text":"Power calculation joint analysis two-stage case control design SNP data.","code":""},{"path":"https://nanx.me/cats/reference/cats-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats-package","text":"Skol AD, Scott LJ, Abecasis GR, Boehnke M: Joint analysis efficient replication-based analysis two-stage genome-wide association studies. Nat Genet 38: 209-213, 2006.","code":""},{"path":[]},{"path":"https://nanx.me/cats/reference/cats-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats-package","text":"Anders Albrechtsen <albrecht@binf.ku.dk>","code":""},{"path":"https://nanx.me/cats/reference/cats-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats-package","text":"","code":"# calculate the power under a multiplicative model using a # two stage design and assuming a relative risk of 1.5 cats(   freq = 0.2,   ncases = 500, ncases2 = 500,   ncontrols = 1000, ncontrols2 = 1000,   risk = 1.5, multiplicative = 1 ) #> Expected Power is; #>  #>       #>  #>                    For a one-stage study = 0.94 #>       For first stage in two-stage study = 0.972 #> For second stage in replication analysis = 0.784 #>     For second stage in a joint analysis = 0.929 #>                                       pi = 0.5 #>"},{"path":"https://nanx.me/cats/reference/cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"Power calculation joint analysis two-stage case control design SNP data.","code":""},{"path":"https://nanx.me/cats/reference/cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"","code":"cats(   freq = 0.5,   freq2 = -1,   ncases = 500,   ncontrols = 500,   ncases2 = 500,   ncontrols2 = 500,   risk = 1.5,   risk2 = -1,   pisamples = -1,   prevalence = 0.1,   prevalence2 = -1,   additive = 0,   recessive = 0,   dominant = 0,   multiplicative = 1,   alpha = 1e-07,   pimarkers = 0.00316 )"},{"path":"https://nanx.me/cats/reference/cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"freq numeric. minor allele frequency (MAF) first stage freq2 numeric. MAF second stage, Optional, -1 value first stage given ncases integer. number cases first stage ncontrols integer. number controls first stage ncases2 integer. number cases second stage ncontrols2 integer. number controls second stage risk numeric. relative risk first stage risk2 numeric. relative risk second stage, Optional, -1 value first stage given pisamples numeric. weights used joint statistic. Optional. see details prevalence numeric. prevalence disease population first stage prevalence2 numeric. prevalence disease population second stag, Optional, -1 value first stage given additive boolean. 1 additive model assumed recessive boolean. 1 recessive model assumed dominant boolean. 1 dominant model assumed multiplicative boolean. 1 multiplicative model assumed alpha numeric. significance threshold. Often threshold 0.05 divided number markers chosen pimarkers numeric. fraction markers genotyped second stage","code":""},{"path":"https://nanx.me/cats/reference/cats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"P.one.study power one study performed, NB! valid estimate relative risk allele frequency stages P.first.stage power marker proceed second stage P.rep.study power study based replication joint analysis P.joint.min power joint analysis tp detect least one susceptibility SNP assuming five susceptibility SNPs exits P.joint power joint analysis pi weight used calculate joint statistic T.one.study Recommended thresholds one-stage study T.first.stage Recommended thresholds first stage two-stage study T.second.stage.rep Recommended thresholds second stage replication analysis T.second.stage.joint Recommended thresholds second stage joint analysis E.Disease.freq.cases1 expected disease allele frequency stage 1 cases E.Disease.freq.controls1 expected disease allele frequency stage 1 controls E.Disease.freq.cases2 expected disease allele frequency stage 2 cases E.Disease.freq.controls2 expected disease allele frequency stage 2 controls","code":""},{"path":"https://nanx.me/cats/reference/cats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"power analysis based Skol et al. 2006, generized ratio cases controls may vary stages. Also allele frequencies, disease prevalence relative risk also allowed vary. joint statistic $z_joint=z_1\\sqrt\\pi+z_2\\sqrt1-\\pi$ $z_1$ z-score first stage weight $\\pi$ calculated $\\pi=1/var(\\hatp'_1-\\hatp_1)*(1/var(\\hatp'_1-\\hatp_1)+1/var(\\hatp'_2-\\hatp_2))^-1$, $\\hatp'_1$ estimate allele frequency cases first stage. consistent Skol et al 2006 ratios cases controls stages. case weight $\\pi$ may vary slightly different allele frequencies different relative risks. power calculations recommend calculating weight likely scenario 80-90% power fixing weights scenarios (testing real data) weight. can done assigning pisample value. practice hardly affect power.","code":""},{"path":"https://nanx.me/cats/reference/cats.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"Skol AD, Scott LJ, Abecasis GR, Boehnke M: Joint analysis efficient replication-based analysis two-stage genome-wide association studies. Nat Genet 38: 209-213, 2006.","code":""},{"path":[]},{"path":"https://nanx.me/cats/reference/cats.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"Anders Albrechtsen","code":""},{"path":"https://nanx.me/cats/reference/cats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Power calculation for a joint analysis of a two-stage case control design\nfor SNP data — cats","text":"","code":"# calculate the power under a multiplicative model using a two stage design # and assuming a relative risk of 1.5 cats(   freq = 0.2,   ncases = 500, ncases2 = 500,   ncontrols = 1000, ncontrols2 = 1000,   risk = 1.5, multiplicative = 1 ) #> Expected Power is; #>  #>       #>  #>                    For a one-stage study = 0.94 #>       For first stage in two-stage study = 0.972 #> For second stage in replication analysis = 0.784 #>     For second stage in a joint analysis = 0.929 #>                                       pi = 0.5 #>   power.J <- c() power.R <- c() power.O <- c() RR <- 23:32 / 20 for (tal in 1:length(RR)) {   temp <- cats(risk = RR[tal])   power.J[tal] <- temp$P.joint   power.R[tal] <- temp$P.rep.study   power.O[tal] <- temp$P.one.study } plot(RR, power.J, type = \"b\", lwd = 2, ylab = \"Power\") lines(RR, power.R, lwd = 2, col = 2, type = \"b\") lines(RR, power.O, lwd = 2, col = 3, type = \"b\") legend(1.4, 0.4, c(   \"joint analysis\", \"replication design\",   \"one stage design\" ), col = 1:3, lwd = 3, bty = \"n\")"},{"path":"https://nanx.me/cats/reference/curve.cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Curves plot for cats object — curve.cats","title":"Curves plot for cats object — curve.cats","text":"Curves plot cats object","code":""},{"path":"https://nanx.me/cats/reference/curve.cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Curves plot for cats object — curve.cats","text":"","code":"curve.cats(   RR,   MAF,   rep = 1536,   SNPs = 1e+06,   ncases,   ncontrols,   ncases2,   ncontrols2,   alpha = 0.05/SNPs,   ... )"},{"path":"https://nanx.me/cats/reference/curve.cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Curves plot for cats object — curve.cats","text":"RR description MAF description rep description SNPs description ncases description ncontrols description ncases2 description ncontrols2 description alpha description ... description","code":""},{"path":"https://nanx.me/cats/reference/lines.cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Line plots for cats object — lines.cats","title":"Line plots for cats object — lines.cats","text":"Line plots cats object","code":""},{"path":"https://nanx.me/cats/reference/lines.cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Line plots for cats object — lines.cats","text":"","code":"# S3 method for cats lines(x, type = \"Replication\", col = NULL, lty = 2, ...)"},{"path":"https://nanx.me/cats/reference/lines.cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Line plots for cats object — lines.cats","text":"x description type description col description lty description ... description","code":""},{"path":"https://nanx.me/cats/reference/plot.supercats.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot supercats — plot.supercats","title":"Plot supercats — plot.supercats","text":"Plot supercats","code":""},{"path":"https://nanx.me/cats/reference/plot.supercats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot supercats — plot.supercats","text":"","code":"# S3 method for supercats plot(   x,   type = \"Joint\",   file = \"power.pdf\",   col = NULL,   main = paste(\"POWER N=\", x$ncases, \":\", x$ncontrols, \",\", x$ncases2, \":\",     x$ncontrols2, \" rep=\", x$rep, sep = \"\"),   ... )"},{"path":"https://nanx.me/cats/reference/plot.supercats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot supercats — plot.supercats","text":"x description type description file description col description main description ... description","code":""},{"path":"https://nanx.me/cats/reference/print.cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the calculated power — print.cats","title":"Print the calculated power — print.cats","text":"Print calculated power","code":""},{"path":"https://nanx.me/cats/reference/print.cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the calculated power — print.cats","text":"","code":"# S3 method for cats print(x, ...)"},{"path":"https://nanx.me/cats/reference/print.cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the calculated power — print.cats","text":"x cats object ... Dynamic parameter values additional parameters summary method","code":""},{"path":[]},{"path":"https://nanx.me/cats/reference/summary.cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of a cats object — summary.cats","title":"Summary of a cats object — summary.cats","text":"Summary cats object","code":""},{"path":"https://nanx.me/cats/reference/summary.cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary of a cats object — summary.cats","text":"","code":"# S3 method for cats summary(object, ...)"},{"path":"https://nanx.me/cats/reference/summary.cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of a cats object — summary.cats","text":"object cats object ... Dynamic parameter values additional parameters print method","code":""},{"path":[]},{"path":"https://nanx.me/cats/reference/summary.cats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary of a cats object — summary.cats","text":"","code":"x <- cats() summary(x) #> Options  #>                   chosen #> freq            5.00e-01 #> freq2          -1.00e+00 #> ncases          5.00e+02 #> ncontrols       5.00e+02 #> ncases2         5.00e+02 #> ncontrols2      5.00e+02 #> risk            1.50e+00 #> risk2          -1.00e+00 #> pisamples      -1.00e+00 #> prevalence      1.00e-01 #> prevalence2    -1.00e+00 #> additive        0.00e+00 #> recessive       0.00e+00 #> dominant        0.00e+00 #> multiplicative  1.00e+00 #> alpha           1.00e-07 #> pimarkers       3.16e-03 #> Recommended thresholds: #>       #>  #>         One stage Design = 5.326724 #>        Stage 1 Threshold = 2.951729 #>    Replication Threshold = 4.000192 #> Joint Analysis Threshold = 5.30794 #>  #> Eobjectpected disesase allele frequencies #>       #>  #>     Cases in stage 1 = 0.6 #> Controls in stage 1  = 0.4888889 #>     Cases in stage 2 = 0.6 #>  Controls in stage 2 = 0.4888889 #>  #> Expected Power is: #>       #>  #>                    For a one-stage study = 0.962 #>       For first stage in two-stage study = 0.981 #> For second stage in replication analysis = 0.83 #>     For second stage in a joint analysis = 0.953 #>                                       pi = 0.5 #>"},{"path":"https://nanx.me/cats/reference/super.cats.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate supercats — super.cats","title":"Generate supercats — super.cats","text":"Generate supercats","code":""},{"path":"https://nanx.me/cats/reference/super.cats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate supercats — super.cats","text":"","code":"super.cats(   RR,   MAFmax = 0.5,   MAFmin = 0.005,   by = 50,   rep = 1536,   SNPs = 1e+06,   ncases,   ncontrols,   ncases2,   ncontrols2,   alpha = 0.05/SNPs,   ... )"},{"path":"https://nanx.me/cats/reference/super.cats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate supercats — super.cats","text":"RR description MAFmax description MAFmin description description rep description SNPs description ncases description ncontrols description ncases2 description ncontrols2 description alpha description ... description","code":""}]
