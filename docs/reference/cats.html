<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Power calculation for a joint analysis of a two-stage case control design
for SNP data — cats • cats</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Power calculation for a joint analysis of a two-stage case control design
for SNP data — cats" />
<meta property="og:description" content="Power calculation for a joint analysis of a two-stage case control design
for SNP data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cats.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nanxstats/cats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power calculation for a joint analysis of a two-stage case control design
for SNP data</h1>
    <small class="dont-index">Source: <a href='https://github.com/nanxstats/cats/blob/master/R/cats.R'><code>R/cats.R</code></a></small>
    <div class="hidden name"><code>cats.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Power calculation for a joint analysis of a two-stage case control design
for SNP data.</p>
    </div>

    <pre class="usage"><span class='fu'>cats</span><span class='op'>(</span>
  freq <span class='op'>=</span> <span class='fl'>0.5</span>,
  freq2 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>,
  ncases <span class='op'>=</span> <span class='fl'>500</span>,
  ncontrols <span class='op'>=</span> <span class='fl'>500</span>,
  ncases2 <span class='op'>=</span> <span class='fl'>500</span>,
  ncontrols2 <span class='op'>=</span> <span class='fl'>500</span>,
  risk <span class='op'>=</span> <span class='fl'>1.5</span>,
  risk2 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>,
  pisamples <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>,
  prevalence <span class='op'>=</span> <span class='fl'>0.1</span>,
  prevalence2 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>,
  additive <span class='op'>=</span> <span class='fl'>0</span>,
  recessive <span class='op'>=</span> <span class='fl'>0</span>,
  dominant <span class='op'>=</span> <span class='fl'>0</span>,
  multiplicative <span class='op'>=</span> <span class='fl'>1</span>,
  alpha <span class='op'>=</span> <span class='fl'>1e-07</span>,
  pimarkers <span class='op'>=</span> <span class='fl'>0.00316</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>freq</th>
      <td><p>numeric. The minor allele frequency (MAF) in the first stage</p></td>
    </tr>
    <tr>
      <th>freq2</th>
      <td><p>numeric. The MAF in the second stage, Optional, if -1 the same
value as for the first stage is given</p></td>
    </tr>
    <tr>
      <th>ncases</th>
      <td><p>integer. The number of cases in the first stage</p></td>
    </tr>
    <tr>
      <th>ncontrols</th>
      <td><p>integer. The number of controls in the first stage</p></td>
    </tr>
    <tr>
      <th>ncases2</th>
      <td><p>integer. The number of cases in the second stage</p></td>
    </tr>
    <tr>
      <th>ncontrols2</th>
      <td><p>integer. The number of controls in the second stage</p></td>
    </tr>
    <tr>
      <th>risk</th>
      <td><p>numeric. The relative risk in the first stage</p></td>
    </tr>
    <tr>
      <th>risk2</th>
      <td><p>numeric. The relative risk in the second stage, Optional, if -1
the same value as for the first stage is given</p></td>
    </tr>
    <tr>
      <th>pisamples</th>
      <td><p>numeric. The weights used for the joint statistic.
Optional. see details</p></td>
    </tr>
    <tr>
      <th>prevalence</th>
      <td><p>numeric. The prevalence of the disease in the population
for the first stage</p></td>
    </tr>
    <tr>
      <th>prevalence2</th>
      <td><p>numeric. The prevalence of the disease in the population
for the second stag, Optional, if -1 the same value as for the first stage
is given</p></td>
    </tr>
    <tr>
      <th>additive</th>
      <td><p>boolean. if 1 an additive model is assumed</p></td>
    </tr>
    <tr>
      <th>recessive</th>
      <td><p>boolean. if 1 a recessive model is assumed</p></td>
    </tr>
    <tr>
      <th>dominant</th>
      <td><p>boolean. if 1 a dominant model is assumed</p></td>
    </tr>
    <tr>
      <th>multiplicative</th>
      <td><p>boolean. if 1 a multiplicative model is assumed</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>numeric. The significance threshold. Often the a threshold of
0.05 divided by the number of markers is chosen</p></td>
    </tr>
    <tr>
      <th>pimarkers</th>
      <td><p>numeric. The fraction of markers genotyped in the second
stage</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>P.one.study</dt><dd><p>The power if only one study was performed, NB!
This is only a valid estimate if the relative risk and allele frequency is
the same for both stages</p></dd> <dt>P.first.stage</dt><dd><p>The power for a marker to
proceed the the second stage</p></dd> <dt>P.rep.study </dt><dd><p>The power of the study if
based on replication and not a joint analysis</p></dd> <dt>P.joint.min </dt><dd><p>The power
of the joint analysis tp detect at least one susceptibility SNP assuming
that five susceptibility SNPs exits</p></dd> <dt>P.joint </dt><dd><p>The power of the joint
analysis</p></dd> <dt>pi </dt><dd><p>The weight used to calculate the joint statistic</p></dd>
<dt>T.one.study</dt><dd><p>Recommended thresholds for a one-stage study</p></dd>
<dt>T.first.stage </dt><dd><p>Recommended thresholds for the first stage in
two-stage study</p></dd> <dt>T.second.stage.rep </dt><dd><p>Recommended thresholds for the
second stage in replication analysis</p></dd> <dt>T.second.stage.joint
</dt><dd><p>Recommended thresholds for the second stage in a joint analysis</p></dd>
<dt>E.Disease.freq.cases1 </dt><dd><p>The expected disease allele frequency in stage
1 for cases</p></dd> <dt>E.Disease.freq.controls1 </dt><dd><p>The expected disease allele
frequency in stage 1 for controls</p></dd> <dt>E.Disease.freq.cases2 </dt><dd><p>The
expected disease allele frequency in stage 2 for cases</p></dd>
<dt>E.Disease.freq.controls2 </dt><dd><p>The expected disease allele frequency in
stage 2 for controls</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These power analysis are based on Skol et al. 2006, But are generized so
that the ratio between cases and controls may vary between stages. Also the
allele frequencies, disease prevalence and relative risk are also allowed to
vary. The joint statistic $z_joint=z_1\sqrt\pi+z_2\sqrt1-\pi$ where $z_1$ is
the z-score for the first stage and the weight $\pi$ is calculated as
$\pi=1/var(\hatp'_1-\hatp_1)*(1/var(\hatp'_1-\hatp_1)+1/var(\hatp'_2-\hatp_2))^-1$,
where $\hatp'_1$ is the estimate of the allele frequency of the cases in the
first stage. This is consistent with Skol et al 2006 when the ratios of
cases and controls are the same in both stages. When this is not the case
the weight $\pi$ may vary slightly with different allele frequencies and
different relative risks. For power calculations I would recommend
calculating the weight at a likely scenario where there is about 80-90%
power and fixing the weights at other scenarios (and the testing of the real
data) to this weight. This can be done by assigning pisample to a value. In
practice this will hardly affect the power.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Skol AD, Scott LJ, Abecasis GR, Boehnke M: Joint analysis is
more efficient than replication-based analysis for two-stage genome-wide
association studies. Nat Genet 38: 209-213, 2006.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='http://www.sph.umich.edu/csg/abecasis/CaTS/'>http://www.sph.umich.edu/csg/abecasis/CaTS/</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anders Albrechtsen</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># calculate the power under a multiplicative model using a two stage design</span>
<span class='co'># and assuming a relative risk of 1.5</span>
<span class='fu'>cats</span><span class='op'>(</span>
  freq <span class='op'>=</span> <span class='fl'>0.2</span>,
  ncases <span class='op'>=</span> <span class='fl'>500</span>, ncases2 <span class='op'>=</span> <span class='fl'>500</span>,
  ncontrols <span class='op'>=</span> <span class='fl'>1000</span>, ncontrols2 <span class='op'>=</span> <span class='fl'>1000</span>,
  risk <span class='op'>=</span> <span class='fl'>1.5</span>, multiplicative <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; Expected Power is;
#&gt; 
#&gt;      
#&gt; 
#&gt;                    For a one-stage study = 0.94
#&gt;       For first stage in two-stage study = 0.972
#&gt; For second stage in replication analysis = 0.784
#&gt;     For second stage in a joint analysis = 0.929
#&gt;                                       pi = 0.5
#&gt; </div><div class='input'>
<span class='va'>power.J</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>power.R</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>power.O</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>RR</span> <span class='op'>&lt;-</span> <span class='fl'>23</span><span class='op'>:</span><span class='fl'>32</span> <span class='op'>/</span> <span class='fl'>20</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>tal</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>RR</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'>cats</span><span class='op'>(</span>risk <span class='op'>=</span> <span class='va'>RR</span><span class='op'>[</span><span class='va'>tal</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>power.J</span><span class='op'>[</span><span class='va'>tal</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>$</span><span class='va'>P.joint</span>
  <span class='va'>power.R</span><span class='op'>[</span><span class='va'>tal</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>$</span><span class='va'>P.rep.study</span>
  <span class='va'>power.O</span><span class='op'>[</span><span class='va'>tal</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>$</span><span class='va'>P.one.study</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>RR</span>, <span class='va'>power.J</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, ylab <span class='op'>=</span> <span class='st'>"Power"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>RR</span>, <span class='va'>power.R</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='fl'>2</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>RR</span>, <span class='va'>power.O</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='fl'>3</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='fl'>1.4</span>, <span class='fl'>0.4</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
  <span class='st'>"joint analysis"</span>, <span class='st'>"replication design"</span>,
  <span class='st'>"one stage design"</span>
<span class='op'>)</span>, col <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, lwd <span class='op'>=</span> <span class='fl'>3</span>, bty <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span>
</div><div class='img'><img src='cats-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anders Albrechtsen, Nan Xiao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


